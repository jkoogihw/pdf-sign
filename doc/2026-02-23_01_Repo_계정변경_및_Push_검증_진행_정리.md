# Repo 계정 변경 및 Push 검증 진행 정리

## 1. 목적
- GitHub 저장소 계정/연결 변경 과정에서 원격(`origin`) 설정 정상화
- `dev` 기준 동기화/푸시 가능성 검증
- 프록시 환경 이슈 진단 및 재현 가능한 점검 절차 문서화

## 2. 진행 과정 요약

### 2.1 Remote 설정 정상화
아래 절차로 `origin`을 `jkoogihw/pdf-sign`으로 설정/확인했다.

```bash
git -C /workspace/pdf-sign remote add origin https://github.com/jkoogihw/pdf-sign.git
git -C /workspace/pdf-sign remote set-url origin https://github.com/jkoogihw/pdf-sign.git
git -C /workspace/pdf-sign remote -v
```

현재 저장소의 `.git/config`에도 동일 URL이 기록된 상태다.

### 2.2 PAT 기반 fetch 검증
PAT를 이용한 `fetch origin dev`가 사용자 환경에서는 성공했으며, `origin/dev` 참조가 생성된 로그를 확인했다.

```bash
git -C /workspace/pdf-sign -c http.extraHeader="Authorization: Basic $(printf 'x-access-token:%s' "$GITHUB_PAT" | base64 -w0)" fetch origin dev
```

성공 로그 예시:
- `From https://github.com/jkoogihw/pdf-sign`
- `* branch dev -> FETCH_HEAD`
- `* [new branch] dev -> origin/dev`

### 2.3 브랜치 비교 결과 해석
사용자 제공 결과 기준:
- `HEAD = 983651c`
- `origin/dev = 8b792fd`
- `git rev-list --left-right --count HEAD...origin/dev` 결과 `1 0`

의미:
- 로컬 HEAD가 `origin/dev`보다 **1 commit 앞서 있음**
- 즉 fast-forward 가능한 상태이며, 대상 브랜치 지정만 정확하면 push 가능

### 2.4 push 오류 원인 정리
`git push --dry-run origin dev`에서 `src refspec dev does not match any`가 발생한 이유는
로컬 `dev` 브랜치가 없기 때문이다.

해결 방법(둘 중 하나):

```bash
# 방법 A: 현재 HEAD를 원격 dev로 직접 푸시
git -C /workspace/pdf-sign push origin HEAD:dev

# 방법 B: 로컬 dev 생성 후 푸시
git -C /workspace/pdf-sign switch -c dev
git -C /workspace/pdf-sign push -u origin dev
```

## 3. 현재 Codex 런타임 기준 점검 결과
이 런타임은 프록시(`CONNECT 403`) 제약이 간헐/지속적으로 발생할 수 있어,
동일 명령이 환경에 따라 실패할 수 있다.

- `git ls-remote origin`
- `git push --dry-run origin HEAD:dev`

위 두 명령은 현재 런타임에서 `CONNECT tunnel failed, response 403`로 실패 확인됨.

## 4. 진행 중 생성한 자료
계정/프록시 이슈 대응을 위해 아래 자료를 생성/활용했다.

1. `scripts/git-proxy-helper.sh`
   - remote 설정, 프록시 설정/초기화, 연결 테스트 자동화
2. `doc/GIT_PROXY_AND_REMOTE_SETUP.md`
   - `.git/config` 접근법, remote 설정법, PAT 적용 및 실패 트러블슈팅 가이드

## 5. 최종 체크리스트
- [x] `origin` URL이 `https://github.com/jkoogihw/pdf-sign.git`인지 확인
- [x] PAT 기반 `fetch origin dev` 성공 여부 확인(사용자 환경)
- [x] `HEAD...origin/dev` 비교로 앞/뒤 관계 파악
- [x] push 시 브랜치 refspec 오류 원인/해결 절차 정리
- [x] 문서화 및 재실행 가능한 커맨드 정리
